"use strict";$.fn.CollapsibleMenu=function(options){function process(submenu){submenu.css("overflow-y","hidden");var calculatedheight=submenu[0].scrollHeight;submenu.data("calculated-height",calculatedheight),submenu.css("max-height",calculatedheight+"px"),submenu.children("li").children("ul").each(function(){process($(this))}),submenu.hasClass(settings.expandClass)||collapse(submenu)}function collapse(submenu){var container=submenu.parent();submenu.animate({"max-height":0},{duration:settings.animationTime,complete:function(){submenu.removeClass(settings.expandClass),container.removeClass(settings.collapsedContainerClass)}})}function expand(submenu,firstexpand){var calculatedheight=submenu.data("calculated-height"),container=submenu.parent();!0!==firstexpand&&submenu.parent().parent().find("li ul.open").each(function(){collapse($(this))}),submenu.animate({"max-height":calculatedheight+"px"},{duration:settings.animationTime}),submenu.addClass(settings.expandClass),container.addClass(settings.collapsedContainerClass),container.addClass("background")}function detectCurrent(element){var i,childrenlsits=element.children("li");for(i=0;i<childrenlsits.length;i++){var menuitem=$(childrenlsits[i]);if(isActive(menuitem))return menuitem.addClass("active"),!0}}function isActive(menuitem){var i,anchor=menuitem.children("a"),submenu=menuitem.children("ul");if(submenu.length>0){var childrenlists=submenu.children("li");for(i=0;i<childrenlists.length;i++){if(isActive($(childrenlists[i])))return submenu.addClass("open"),!0}}else if(anchor.length>0&&0!==anchor.attr("href").indexOf("#")){var link=anchor.prop("href");link=link.split("#")[0];var parts=link.split("/").slice(3),filepath="/"+parts.join("/");if(filepath==window.location.pathname)return menuitem.addClass("active"),!0;if(filepath+"/index.html"==window.location.pathname||filepath==window.location.pathname+"index.html")return menuitem.addClass("active"),!0}return!1}var settings=$.extend({animationTime:300,expandClass:"open",collapsedContainerClass:"active",autoDetectActive:!1},options);this.each(function(){var element=$(this);settings.autoDetectActive&&detectCurrent(element),element.children("li").children("ul").each(function(){process($(this))}),element.on("click","li a",function(event){$(this).blur();var submenu=$(this).siblings("ul");submenu.length>0&&(event.preventDefault(),submenu.hasClass(settings.expandClass)?collapse(submenu):expand(submenu))})})};